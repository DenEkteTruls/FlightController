<!doctype html>
<html lang="no">
  <head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
   integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
   crossorigin=""/>
   <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
   integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
   crossorigin=""></script>
   <script src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@0.71.1/dist/L.Control.Locate.min.js" charset="utf-8"></script>
  </head>
  <body>
    <div class="container">
        <div id="map" style="height: 100vh;"></div>
    </div>
  </body>
  <script>

    let socket = new WebSocket("ws://localhost:8081");

    var count = 1;
    var last_marker = []

    var map = L.map("map").setView([59.419501, 10.487164], 16);

    L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
      maxZoom: 22,
      id: 'mapbox/streets-v11',
      tileSize: 512,
      zoomOffset: -1,
      accessToken: 'pk.eyJ1IjoiZGVuZWt0ZXRydWxzIiwiYSI6ImNrOWgwbzJiNjA4OHozbm13bjZxMjVwZTMifQ.VtqneIR4Cwwx-iYGjhLFxw'
    }).addTo(map);

    map.on("click", function(e) {
      var height = prompt("HÃ¸yde");
      if(height) {
        L.marker(e.latlng).bindPopup("<b>"+count+"</b><br>"+height+"m").addTo(map);
        if(last_marker) {
          L.polyline([last_marker, e.latlng], {color: "red"}).addTo(map);
        }
        last_marker = e.latlng;
        socket.send(count+"|"+e.latlng.lat+"|"+e.latlng.lng+"|"+height);
        count += 1;
      }
    });

  </script>
</html>